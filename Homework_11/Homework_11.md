#第十三次作业#

##· 摘要 ##
本次作业完成了第十三次作业，完成了作业5.3题的尝试：

>***5.3 通过电容器的对称性写一个程序得到X-Y平面一个象限的势能计算结果**

##· 背景介绍 ##
在不存在电荷的空间中，电势的分布遵循拉普拉斯方程:

![](http://i.imgur.com/XE6WXcX.png)

理论上，只要在一定的边界条件下求解就可以得到静电势的空间分布，但是除了一些特殊的边界条件以外，对于这类问题我们难以得到解析解。所以我们必须使用数值计算的方法，得到电势的数值解。

本文采用松弛算法(relaxation method)去求解。

松弛算法的一种为Jacobi方法。Jacobi方法的精髓是从一个符合边界条件的猜测解开始，通过迭代，使得数值解收敛于真实的解。

Jacobi方法的改进版是Gauss-Seidel方法。在计算中，我们总是算完一个点再算另一个点，也就是逐点更新计算结果。该方法主要的改进是在计算某一点的电势时，使用之前的点已经更新（update）后的数据。

5.3题给出的是一个平板电容器，要求计算周围的电势。

![](http://i.imgur.com/hNsuBYD.jpg)


##· 正文 ##


####5.3 通过电容器的对称性写一个程序得到X-Y平面一个象限的势能计算结果

**①通过全局迭代得到电势图**

建立平板处为±1，其他地方为0的100*100矩阵后，使用迭代语句令非边界上的点的电势相等于其周围最近的四个点的电势的平均值。在计算某一点的电势时，使用之前的点已经更新（update）后的数据。最终扩散得到全局电势。

运行程序[potential.py](https://github.com/DesertSunset/computationalphysics_N2013301020088/blob/master/chapter%205/The%20thirteen%20homework/potential.py)

得到2D等高线电势图，对应的3D图像和电场线矢量图。

![](http://i.imgur.com/UuI23EL.jpg)

![](http://i.imgur.com/LHt1SnK.jpg)

![](http://i.imgur.com/nqiPvS1.jpg)

可以看出，平板处电势最强，其他地方电势呈发散状。电场线垂直于平板。这与实际情况是相符合的。

**②通过对称性得到电势图（尝试）**

将①中全局迭代i,j的range改为一半，在每一步更新V的操作中，利用对称性得到对面的电势，可节省一半的计算时间。

然而在实际操作中，中轴为i=55，在进行v[110-i][j]=-v[i][j]求对面算符时，老报错list index out of range，还没找到原因，有待进一步改进。

![](http://i.imgur.com/BflZxgz.jpg)


##· 结论 ##

平板处电势最强，其他地方电势呈发散状。电场线垂直于平板。这与实际情况是相符合的。

理论上，将全局迭代i,j的range改为一半，在每一步更新V的操作中，利用对称性得到对面的电势，可节省一半的计算时间。

##· 学习笔记 ##
由于本单元与前几章已经能熟练使用的欧拉法有本质性不同，本章在书写时较多的参考了其他同学的代码，对自己贫乏的编程能力进行了恶补。

当然探索过程还是错误百出，debug到身心十分疲惫的，并且最后也没能完成对称性的修正，实属遗憾。

**1.矩阵的建立**

在一开始设立矩阵时，我首先使用的是zero函数，但是在后来进行循环迭代语句时出现了问题，zero函数建立的空矩阵不是list的数组的形式，在后来没办法找到具体哪行哪列进行代入。我看到其他同学有用zero函数同样做出结果的，但是后期设立的函数比循环迭代语句复杂的多，所以最终抛弃了zero函数，尝试建立多维数组

在这里用到了List = [[0] * 10] * 10来建立宽度为10，高度为10的数组的方法，但进行赋值List[0][1] = 1的尝试时，发现整个第二列都被赋值了1，而不是第一行第二列的一个数赋值。原因是因为浅拷贝的概念，[[0]]*10表示10个指向这个空列表元素的引用,修改任何一个元素都会改变整个列表。所以需要用另外一种方式进行创建多维数组,以免浅拷贝：lists = [([0] * 10) for i in range(10)]

可是最后在进行循环迭代语句时，还是出现了问题，说维数对不上。我再仔细查看，发现建立的多维数组是

[[0,0,0],[0,0,0]，[0,0,0],

[0,0,0],[0,0,0],[0,0,0],

[0,0,0],[0,0,0],[0,0,0],

[0,0,0],[0,0,0],[0,0,0]]


的形式，而迭代语句要求的是

[[0,0,0],[0,0,0]，[0,0,0]],

[[0,0,0],[0,0,0],[0,0,0]],

[[0,0,0],[0,0,0],[0,0,0]],

[[0,0,0],[0,0,0],[0,0,0]]

再套上一个后 lists =[(([0] * 10) for i in range(10)) for j in range(10)]，的确可以达到要求，但是使用list[1][1][1]妄图确认哪行哪列时就发生错误了，没办法赋值。

最终放弃，老老实实也用迭代语句建立了矩阵。

**2.deep拷贝**

Python中的对象之间赋值时是按引用传递的，如果需要拷贝对象，需要使用标准库中的copy模块。 from copy import deepcopy

1. copy.copy 浅拷贝 只拷贝父对象，不会拷贝对象的内部的子对象。 

2. copy.deepcopy 深拷贝 拷贝对象及其子对象 

教程举了一个非常好的例子，一看就懂，在此分享

![](http://i.imgur.com/G6e0fyu.jpg)



**3.画图**

本次由于课本要求，终于学会了画3D图，勉强了解了画矢量图。

参考[Matplotlib 教程](http://ju.outofmemory.cn/entry/92100)

知道了

meshgrid(X,Y)是建立平面网格

contour()函数是画等高线，clabel（）函数是画等高线高度的标注

colorbar(A)函数是画图像的颜色深度对应大小的色条。其中A应该等于画图的plot函数，而不等于其中的Z轴参量。

只要加上fig = figure()，ax = Axes3D(fig)，然后plot函数也相应变化，要加上ax.前缀以及一些变化，就可以画3D图像了，比我想的简单好多。再加上一些特殊参数就可以绘制好看的彩色图像。不过参数种类真是太多了。

矢量图到现在也没搞清楚，因为网上教的是quiver()函数，我代入却报错。streamplot()函数是同学使用的，网上教程、语法书也没有，并不清楚一些参数是做什么的。


##· 致谢 ##


感谢吴雨桥、刘文焘、张琦、陈洋遥、郭帅斐同学，借鉴了代码与报告。

感谢网络教程

[python的二维数组操作](http://www.cnblogs.com/btchenguang/archive/2012/01/30/2332479.html)

[Python 拷贝对象（深拷贝deepcopy与浅拷贝copy）](http://greybeard.iteye.com/blog/1442259)

[Python科学计算技巧积累八——colormap 和 contour map的绘制](http://www.eetop.cn/blog/html/85/1227585-53936.html)

[matplotlib.pyplot中add_subplot方法参数111的含义](http://www.codeweblog.com/matplotlib-pyplot%E4%B8%ADadd_subplot%E6%96%B9%E6%B3%95%E5%8F%82%E6%95%B0111%E7%9A%84%E5%90%AB%E4%B9%89/)

[Matplotlib 教程](http://ju.outofmemory.cn/entry/92100)
